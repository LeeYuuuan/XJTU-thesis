% !TeX root = ../main.tex

\xchapter{用于脑卒中快速鉴别的生成式EIT图像重建实验}{The Experiment of EIT Reconstruction for Fast Detection of Stroke}
在上一章中，我们通过EIDORS生成的仿真数据对本文提出的生成式EIT图像重建网络进行了训练和评估，验证了该模型能显著提高EIT图像重建结果的重建分辨率。
本章将在该模型的基础上，通过实验验证该模型用于脑卒中快速鉴别的可行性以及其算法的优势。此外，本章还会对训练集的生成进行了研究，并且根据研究结果优化了网络结构。

\xsection{用于脑卒中快速鉴别的生成式EIT图像重建物理实验}{The Physical Experiment of EIT Reconstruction for Fast Detection of Stroke}

\xsubsection{实验方案}{Experiment Scheme and Design}

用于脑卒中快速鉴别的生成式EIT图像重建算法的物理实验流程如下图所示。其中包括EIT成像目设计与制作，EIT采集系统设计与搭建，利用扰动目标和EIT采集系统获得数据以及根据测量数据评估重建算法四个步骤。
本节将重点介绍EIT成像目标的设计与制作以及EIT采集系统的设计与搭建部分。

\xsubsection{EIT成像目标的设计与制作}{Design and Manufacture of EIT Imaging Target}
\label{ImageingTarget}
EIT成像目标包括背景帧以及扰动目标，本节将首先介绍扰动目标的制作流程，随后将阐述背景帧的制作流程。

由于脑卒中可被分为缺血性卒中和失血性卒中，缺血性卒中由于其病灶区域血液（水）含量较少，因此其对应的电导率较低。
而失血性卒中由于其病灶区域大量出血，因此其对应的电导率通常较高。
琼脂是亲水性胶体，在一定温度条件下，向琼脂溶液中加入一定量的电介质即可使其具有特定的电导率。
因此本实验将用琼脂和氯化钠以及水制作出具有不同电导率的琼脂快，来代表不同类型卒中的病灶区域。
本实验将采用2个不同的电导率值作为扰动目标的电导率分布，其分别为0.05S/m 和 0.05S/m。
根据多次试验得，在出每100g水，1.5g琼脂粉的条件下，其琼脂快的电导率$\sigma$(S/m)与氯化钠的含量$x$(g)可用\cref{equation:NACL}近似拟合。
\begin{equation}
    \centering
    \label{equation:NACL}
    \sigma = 2.008x + 0.0207
\end{equation}

此外，本实验用于盛放琼脂并使其凝固的容器为如图所示底面直径不同的陶瓷容器，其底面直径分别为5cm,4cm和2.5cm。
故本所所制作的扰动目标的详细参数如\cref{table:target}所示。

\begin{table}
    \centering
    \caption{扰动目标的参数}
    \begin{tblr}{colspec = {X[c] X[c] X[c] X[c]}}
        \toprule
        编号 & 电导率(S/m) & 底面直径(cm) & 每100g水所需的氯化钠含量(g)\\
        \midrule
        1 & 0.05 & 5 & 0.02 \\
        2 & 0.05 & 4 & 0.02 \\
        3 & 0.05 & 2.5 & 0.02 \\
        4 & 0.5 & 5 & 0.23 \\
        5 & 0.5 & 4 & 0.23 \\
        6 & 0.5 & 2.5 & 0.23 \\
        \bottomrule
    \end{tblr}
    \label{table:target}
\end{table}


具体步骤如\cref{figure:experiment}所示，
\begin{enumerate}
    \item 用电子秤称取1.5g的琼脂粉。
    \item 将称好的琼脂粉倒入烧杯中。
    \item 像烧杯中加入100ml的蒸馏水，并将其与琼脂粉冲分混合。
    \item 再利用电子秤称取一定量的氯化钠粉末。
    \item 将称取的氯化钠粉末倒入琼脂溶液中。
    \item 利用高温加热炉，将上述混合溶液加热纸沸腾，并在加热的过程中冲分搅拌使其溶解（根据实测在常压下需要保持270摄氏度左右）。
    \item 将充分溶解的溶液倒入尺寸不同的陶瓷容器中，静置2小时待其凝固。
    \item 将凝固的琼脂快取出备用。
\end{enumerate}

以上过程为EIT物理模型中扰动目标的制作方式，上述两种扰动目标将分别代表两类卒中的病灶区域。本实验将用硫酸钙溶液来模拟颅内的脑脊液等导体，作为病灶区域的背景帧溶液。
由于电介质的溶解率受到温度、压强、震动等外在因素影响显著，而溶液的电导率对电介质含量非常敏感，因此本实验将利用饱和硫酸钙溶液作为背景帧，以将制作过程中产生的误差降到最低，从而使得仿真过程中使用到的背景电导率与物理实验的背景电导率在最大程度上保持一致。
具体而言，在常温（20-24摄氏度）常压（一个标准大气压），将硫酸钙粉末不断加入到大量纯净水中，静置并等待其完全溶解。重复上述步骤，直到硫酸钙不再溶解，后静置24小时后获得常温常压下稳定的饱和硫酸钙溶液。
将溶液倒入EIT采集系统的丙烯酸玻璃器皿中，静置24小时待其稳定后方可使用。
此外，由于扰动目标与背景溶液接触时，不可避免的会发生离子交换，从而产生误差。因此，为了将这部分误差降至最低，本实验将制作3批作为背景电导率的饱和硫酸钙溶液，每使用6个琼脂块进行成像后将更换背景溶液，从而尽可能得减少背景溶液的电导率的变化。



\begin{figure}[H]
    \centering
    \includegraphics[width=.9\textwidth]{experiment.png}
    \caption{EIT扰动目标制作流程}
    \label{figure:experiment}
\end{figure}

随后利用电阻率测量仪测量上述扰动目标的电导率，验证其电导率的准确性。
本实验中，为了更好的区分不同电导率的扰动目标，用黄色琼脂块表示电导率为0.5S/m的扰动目标
，而用蓝色琼脂块表示电导率为0.05S/m的扰动目标。如图\cref{figure:QiongZhiKuai}所示

\begin{figure}[h]
    \centering

    \includegraphics[width=.7\textwidth]{QiongZhiKuai.png}
    \caption{琼脂块制作示意图}
    \label{figure:QiongZhiKuai}
\end{figure}


\xsubsection{EIT采集系统设计与搭建}{Design and Construction of EIT Measurment System}
EIT采集系统通常包括EIT数据采集测量仪器、用于激励和测量的电极、用于连接激励和测量仪与电极的电缆以及用于控制实验进程、分析和保存数据的控制器（通常为PC）。
本实验采用标准的16电极圆形物理模型容器(16 phantom tank)作为待测场，如\cref{figure:Phantom}所示。该水池的外直径为20cm，内直径为19.4cm，其高度为15cm，材质为丙烯酸玻璃。
该模型共包含16个电极，其材质均为不锈钢A2，切16个电极位于同一平面上，每个电极之间的距离相等。其与电缆连接的部分为香蕉插头，材质均为不锈钢。

电缆为标准的EIT测量电缆集，如\cref{figure:CableSet}所示，其长度为1m，连接类型均为香蕉插头。

测量仪器采用Sciospec Scientific Instruments公司所生产的16通道EIT系统。本实验所采用的的电极激励模式为邻近激励，即单次测量电流的输入和输出分别为1号电极和2号电极，2号电极和3号电极，以此类推，共16次激励。
每次电流激励下该系统将分别测量16个电极的电位，故单次测量所获得的的电位向量为256维。另外，本实验所测得的数据是在单频激励下所得到的，其激励电流的频率为50khz，
激励电流的强度0.0005A。每秒采样的次数为1帧（即该系统理论上每秒向PC输出1组测量电位）。

\begin{figure}
    \centering
    \includegraphics[width=.7\textwidth]{Phantom.png}
    \caption{EIT待测场设置}
    \label{figure:Phantom}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=.7\textwidth]{CableSet.png}
    \caption{EIT连接电缆图示}
    \label{figure:CableSet}
\end{figure}

最后将扰动目标放入其待测场内，即可制作完成用于测量的电导率分布未知场。如\cref{figure:raodongmubiao}
\begin{figure}[h]
    \centering
    \includegraphics[width=.5\textwidth]{raodongmubiao.jpg}
    \caption{待测场图示}
    \label{figure:raodongmubiao}
\end{figure}


\xsection{实验过程}{Experimental Process}
本节将具体的阐述整个物理实验进行的过程。实验共分为两个主要部分。其中，第一部分将利用电导率为0.05S/m的琼脂块作为扰动目标，即\cref{ImageingTarget}中编号为1-3的琼脂块。
分别测量其在物理容器中三个不同位置下的电位数据。
第二部分则是利用电导率为0.5S/m的琼脂块作为扰动目标（\cref{ImageingTarget}中编号为4-6的琼脂块），分别测量其在第一部分中三个位置下的电位数据。

具体开展流程如下：

首先按照\cref{ImageingTarget}中的步骤和具体参数制作电导率为0.05S/m的琼脂块3个。
随后进行实验的第一测量采集。
为防止琼脂块在空气中水分子的流失导致其形变，进而影响其放置在水槽中的稳定性，第二次测量采集需要重新制作电导率为0.5S/m的琼脂块3个，制作好后立即展开第二部分实验。

第一部分其具体流程为：
\begin{enumerate}
    \item 静置好的物理容器连接EIT采集系统，并将EIT采集系统连接至PC，随后通过其串口设置好电流强度、激励频率、激励模式等参数（见上一节），打开EIT采集系统。
    \item 静置1分钟后再，等待20秒，记录20帧背景帧的电位数据的编号信息。
    \item 向硫酸给溶液中位置1处放置1号扰动目标，静置1分钟后记录采集到的20帧电位数据的编号。
    \item 将1号扰动目标移动至位置2，静置1分钟后记录采集到的的20帧电位数据的编号。
    \item 将1号扰动目标移动至位置3，重复上述步骤。
    \item 将1号扰动目标取出，将2号、3号扰动目标分别放置于上述三个位置上，并重复静置、记录的步骤。
    \item 将扰动目标取出，关闭EIT设备。
\end{enumerate}

第二部分对扰动目标为0.5S/m的三个琼脂块开展与第一部分流程相同的实验。至此已获得初步的物理实验数据待后续使用。

随后，本文对上述测得的电位数据进行了分析。由于EIT采集设备所得到的电位向量为测量电极相对于0电位点的电位差，该分布与本文所提出的差分EIT重建算法重建目标不同，故还需要对采集到的数据进行处理，具体操作如下：
该设备采集到的EIT数据共包含16次相邻激励的每个电极所采集到的电位值，该值为一个复数，包含了实部和虚部。而EIT图像重建任务的重建目标（电导率分布）仅和电位的实部相关，因此首先去掉所有电位数据的虚部。
第二，通常EIT所采用的电压信号为两个电极之间的电位差，而本文所采用的电压测量模式为邻近测量，其测量值与仿真数据的电压分布有如 \cref{table:measU} 的映射方式。
\begin{table}
    \centering
    \caption{测量电位的转换方式}
    \begin{tblr}{colspec = {X[c] X[c] X[c] }}
        \toprule
        EIT仿真模型中单次测量所得的向量的下标  & EIT采集系统所得到的与该电压值相关的测量值下标 & 利用测量值获得对应的仿真数据方式\\
        \midrule
        0 & 0,1 & $v_0 - v_1$ \\
        1 & 1,2 & $v_1 - v_2$ \\
        2 & 2,3 & $v_2 - v_3$ \\
        3 & 3,4 & $v_3 - v_4$ \\
        4 & 4,5 & $v_4 - v_5$ \\
        5 & 5,6 & $v_5 - v_6$ \\
        6 & 6,7 & $v_6 - v_7$ \\
        7 & 7,8 & $v_7 - v_8$ \\
        8 & 8,9 & $v_8 - v_9$ \\
        9 & 9,10 & $v_9 - v_{10}$ \\
        10 & 10,11 & $v_{10} - v_{11}$ \\
        11 & 11,12 & $v_{11} - v_{12}$ \\
        12 & 12,13 & $v_{12} - v_{13}$ \\
        13 & 13,14 & $v_{13} - v_{14}$ \\
        14 & 14,15 & $v_{14} - v_{15}$ \\
        15 & 15,0 & $v_{15} - v_{0}$ \\
        
        \bottomrule
    \end{tblr}
    \label{table:measU}
\end{table}

按照上述方式将测得的电位数据映射为重建算法所需要的邻近测量模式的数据，并利用本文所提出的生成式EIT图像重建算法对其内部电导率分布进行重建，
即可获得重建结果。
此外，由于EIT采集系统所采用的采集帧率为每秒1帧，故本文将对每个扰动目标放入物理模型且稳定后静置1分钟，获得60帧数据。
随后在其中随机选择20帧，计算所选数据每个通道上的平均值，利用该值作为最终用于成像的电压数据，以此减小其由于水面波动以及其他外界因素导致的误差。
\xsection{实验结果与分析}{Experiment Results}

上述实验已获得2个不同电导率分布（分别为0.05S/m和0.5S/m）3个不同大小（直径分别为5cm、4cm和2.5cm）的扰动目标分别在饱和硫酸钙溶液中3个不同位置下的电位向量（每个向量包含256个元素）。

其中，0.05S/m，直径分别为5cm和4cm的扰动目标的重建结果如\cref{figure:res_low}， \cref{figure:DRECONS}所示。
\begin{figure}[h]
    \centering
    \includegraphics[width=.5\textwidth]{res_low.JPG}
    \caption{EIT物理实验结果(1)}
    \label{figure:res_low}
\end{figure}
其中，第一行依次分别为5cm的扰动目标分别位于水池中心、水池中心向上2cm处、和水池中心向上4cm处的重建结果；
第二行依次分别为4cm的扰动目标分别位于水池中心、水池中心向左2cm处、和水池中心向左4cm处的重建结果。

而\cref{figure:DRECONS}所示的结果则是扰动目标大小为2.5cm位置分别位于水池中心、水池中心向下2cm处、和水池中心向下4cm处的重建结果。

\begin{figure}[h]
    \centering
    \includegraphics[width=.5\textwidth]{DRECONS.png}
    \caption{EIT物理实验结果(2)}
    \label{figure:DRECONS}
\end{figure}

\cref{figure:res_high}所示为0.5S/m的扰动目标在与上述位置相同的位置下的重建结果。
\begin{figure}[h]
    \centering
    \includegraphics[width=.5\textwidth]{res_high.JPG}
    \caption{EIT物理实验结果(2)}
    \label{figure:res_high}
\end{figure}

根据以上结果可以看出：
\begin{enumerate}
    \item 本文所提出的算法可以有效区分不同电导率下的扰动目标，即可以实现对不同类型的卒中进行快速鉴别。
    \item 该算法一定程度上可以重建出较大目标的位置，并且对于场域中心的目标成像质量也较高（传统的重建算法通常无法对原理边界的扰动目标进行高质量成像）。
    \item 该算法对较小目标的成像结果不是很理想，可以看到，对于直径为2.5cm、电导率为0.05S/m的扰动目标，该算法仅能判断出该目标所属的类型（即电导率分布情况），而无法准确判断出目标的位置。
    \item 该算法无法对成像目标的大小进行准确地重建。
\end{enumerate}

据分析，上述第3条结果可能的原因如下：由于该扰动目标的尺寸较小，同时采集到的数据包含大量噪声，因此该采集结果中信噪比较低，
同时训练集的并没有直接包含该尺寸的扰动目标，故使得该网络无法对该类型的扰动目标准确地提取特征并成像。

虽然网络对该目标的大小和位置成像结果较差，但通过结论可以发现，本文所提出的算法对与原先数据分布有很大差异的电压数据其中有关电导率分布值的特征提取能力较强。
即准确地展现出了该扰动目标的电导率分布，这一定程度上体现出该算法的在对扰动目标电导率分布值的拟合的泛化能力较强。

而第4条结果同样可能是由于扰动目标的半径范围较小，这就导致网络训练不足，从而无法从输入数据中准确提取出扰动目标大小的特征，
进而无法准确重建出扰动目标的大小。

此外，由于EIT图像重建算法固有的病态性，即微小的电压变化就会对重建结果产生巨大的影响，因此本文设计了一个去噪声网络，该网络结构与\cref{RBF}所提出的网络架构基本一致，
不同的是将网络的输出层用一个全连接的网络替代，使得输出结果为一个256维的向量，用于表示该真实电压分布所对应的电压仿真结果，起到了去噪声的效果。
该网络用于拟合真实测量的电压分布到仿真的电压分布的映射，用于对测得的电压分布进行去噪。

具体而言，利用采集到的数据帧进行邻近测量的差分处理后，同时利用同样电导率分布的仿真模型经过EIT正向计算获得电压向量，
利用两个电压向量作为训练数据。其中，仿真的电压数据作为网络的预期输出，而测量所得到的电压数据作为网络的输入数据。
该数据集共包含2000条数据，随后按照训练集-测试集8：2的方式进行划分，由此所得到的去噪网络的

利用该去噪网络，本文对电导率为0.05S/m，底面直径为2.5cm的的扰动目标重新进行了成像，所得到的的结果如\cref{figure:resgood}
\begin{figure}[h]
    \centering
    \includegraphics[width=.5\textwidth]{resgood.png}
    \caption{经过电压去噪声后的重建结果}
    \label{figure:resgood}
\end{figure}

可以看到，经过电压去噪网络后，该算法能有效地重建出小目标的电导率分布。
故在实际的应用中，可以首先针对不同的EIT采集设备设计适用于其的电压去噪声网络，随后去噪后的EIT电压数据进行图像重建任务，
即可最大程度上减少由于测量电压分布于真实电压分布不同而导致的图像重建质量差的问题。

\xsubsection{小结}{Summary}

本章利用本文所提出的生成式EIT图像重建算法，并根据脑卒中的类别设计物理实验，制作了不同的扰目标来验证该算法应用在脑卒中快速鉴别任务上的优势。
随后实现了对于不同电导率分布的扰动目标的图像重建任务。实验结果表明，该算法能有效区分不同电导率的扰动目标，即该算法可用于不同类型的脑卒中快速鉴别任务很中。
此外，本章还设计的一个电压去噪声网络，通过拟合测量电压到仿真电压的映射，从而使得该算法能更有效地重建出小目标的电导率分布。
